# Option to build shared libraries (as opposed to static), default: OFF
option(BUILD_SHARED_LIBS "Build shared libraries" OFF)

file(GLOB_RECURSE SOURCES src/*.cpp
                          src/utility/*.cpp
                          src/Fonts/*.c)

set(INCLUDES  src
              src/Fonts
              src/Fonts/Custom
              src/Fonts/GFXFF
              src/Fonts/TrueType
              src/utility)

# register target library
if(ESP_PLATFORM)
    idf_component_register(SRCS ${SOURCES}
                           INCLUDE_DIRS ${INCLUDES}
                           PRIV_REQUIRES arduino
                           REQUIRES arduino)
else()
    add_library(m5core2 STATIC ${SOURCES})
endif()

target_compile_options(${COMPONENT_LIB} PRIVATE -Wno-unused-variable
                                                -Wno-maybe-uninitialized
                                                -Wno-missing-field-initializers)

# Library only works with ESP32                                                
add_compile_definitions("ESP32")
if(IDF_TARGET STRLESS_EQUAL "ESP32")
    message("M5Core2 library only works with ESP32. Please check your configuration!")
endif()